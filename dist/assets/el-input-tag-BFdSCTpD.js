import{ak as Z,al as ae,am as L,b as Ve,an as W,f as te,ao as ue,V as ee,q as E,L as Ie,ap as le,u as Y,Q as Ne,aq as ke,ar as Me,Z as de,n as Be,d as ce,as as Pe,s as U,o as k,v as q,t as A,y as a,x as w,r as j,a0 as ne,ac as Re,ad as xe,c as H,w as J,a as ze,z as oe,at as se,au as Le,a2 as $e,H as Ae,a4 as Fe,e as Ke,av as Oe,N as Ue,E as re,A as qe,B as He,a7 as We}from"./index-D4k4FYDa.js";import{t as ie,E as Ge}from"./el-scrollbar-DXN0UVJ8.js";import{u as Qe,a as Xe,b as Ze,c as je,d as Je}from"./use-form-common-props-Cy1teft4.js";import{I as fe,C as z,U as F,u as Ye,a as ea}from"./index-DROVk09F.js";import{u as aa}from"./el-select-DQZWitfj.js";import{u as ta}from"./el-col-mfbju-r7.js";const la=Ve({modelValue:{type:te(Array)},max:Number,tagType:{...ie.type,default:"info"},tagEffect:ie.effect,trigger:{type:te(String),default:W.enter},draggable:{type:Boolean,default:!1},delimiter:{type:[String,RegExp],default:""},size:Qe,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),na={[F]:e=>ae(e)||L(e),[z]:e=>ae(e)||L(e),[fe]:e=>Z(e),"add-tag":e=>Z(e),"remove-tag":e=>Z(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function oa({props:e,emit:o,formItem:f}){const g=Xe(),_=Ze(),m=ue(),n=ee(),v=E(()=>["small"].includes(_.value)?"small":"default"),S=E(()=>{var t;return(t=e.modelValue)!=null&&t.length?void 0:e.placeholder}),u=E(()=>!(e.readonly||g.value)),p=E(()=>{var t,l;return L(e.max)?!1:((l=(t=e.modelValue)==null?void 0:t.length)!=null?l:0)>=e.max}),s=t=>{var l,i;if(p.value){n.value=void 0;return}if(!B.value){if(e.delimiter){const y=(l=n.value)==null?void 0:l.replace(e.delimiter,"");y?.length!==((i=n.value)==null?void 0:i.length)&&(n.value=y,b())}o(fe,t.target.value)}},M=t=>{var l;if(!B.value)switch(t.code){case e.trigger:t.preventDefault(),t.stopPropagation(),b();break;case W.numpadEnter:e.trigger===W.enter&&(t.preventDefault(),t.stopPropagation(),b());break;case W.backspace:!n.value&&((l=e.modelValue)!=null&&l.length)&&(t.preventDefault(),t.stopPropagation(),c(e.modelValue.length-1));break}},b=()=>{var t,l;const i=(t=n.value)==null?void 0:t.trim();if(!i||p.value)return;const y=[...(l=e.modelValue)!=null?l:[],i];o(F,y),o(z,y),o("add-tag",i),n.value=void 0},c=t=>{var l;const i=((l=e.modelValue)!=null?l:[]).slice(),[y]=i.splice(t,1);o(F,i),o(z,i),o("remove-tag",y)},r=()=>{n.value=void 0,o(F,void 0),o(z,void 0),o("clear")},h=(t,l,i)=>{var y;const P=((y=e.modelValue)!=null?y:[]).slice(),[G]=P.splice(t,1),Q=l>t&&i==="before"?-1:l<t&&i==="after"?1:0;P.splice(l+Q,0,G),o(F,P),o(z,P)},T=()=>{var t;(t=m.value)==null||t.focus()},C=()=>{var t;(t=m.value)==null||t.blur()},{wrapperRef:D,isFocused:R}=Ye(m,{disabled:g,afterBlur(){var t;e.saveOnBlur?b():n.value=void 0,e.validateEvent&&((t=f?.validate)==null||t.call(f,"blur").catch(l=>le()))}}),{isComposing:B,handleCompositionStart:x,handleCompositionUpdate:V,handleCompositionEnd:I}=ea({afterComposition:s});return Ie(()=>e.modelValue,()=>{var t;e.validateEvent&&((t=f?.validate)==null||t.call(f,z).catch(l=>le()))}),{inputRef:m,wrapperRef:D,isFocused:R,isComposing:B,inputValue:n,size:_,tagSize:v,placeholder:S,closable:u,disabled:g,inputLimit:p,handleDragged:h,handleInput:s,handleKeydown:M,handleAddTag:b,handleRemoveTag:c,handleClear:r,handleCompositionStart:x,handleCompositionUpdate:V,handleCompositionEnd:I,focus:T,blur:C}}function sa(){const e=ee(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function ra({wrapperRef:e,handleDragged:o,afterDragged:f}){const g=Y("input-tag"),_=ue(),m=ee(!1);let n,v,S,u;function p(c){return`.${g.e("inner")} .${g.namespace.value}-tag:nth-child(${c+1})`}function s(c,r){n=r,v=e.value.querySelector(p(r)),v&&(v.style.opacity="0.5"),c.dataTransfer.effectAllowed="move"}function M(c,r){if(S=r,c.preventDefault(),c.dataTransfer.dropEffect="move",L(n)||n===r){m.value=!1;return}const h=e.value.querySelector(p(r)).getBoundingClientRect(),T=n+1!==r,C=n-1!==r,D=c.clientX-h.left,R=T?C?.5:1:-1,B=C?T?.5:0:1;D<=h.width*R?u="before":D>h.width*B?u="after":u=void 0;const x=e.value.querySelector(`.${g.e("inner")}`),V=x.getBoundingClientRect(),I=Number.parseFloat(Ne(x,"gap"))/2,t=h.top-V.top;let l=-9999;if(u==="before")l=Math.max(h.left-V.left-I,Math.floor(-I/2));else if(u==="after"){const i=h.right-V.left;l=i+(V.width===i?Math.floor(I/2):I)}ke(_.value,{top:`${t}px`,left:`${l}px`}),m.value=!!u}function b(c){c.preventDefault(),v&&(v.style.opacity=""),u&&!L(n)&&!L(S)&&n!==S&&o(n,S,u),m.value=!1,n=void 0,v=null,S=void 0,u=void 0,f?.()}return{dropIndicatorRef:_,showDropIndicator:m,handleDragStart:s,handleDragOver:M,handleDragEnd:b}}function ia({props:e,isFocused:o,hovering:f,disabled:g,inputValue:_,size:m,validateState:n,validateIcon:v,needStatusIcon:S}){const u=Me(),p=de(),s=Y("input-tag"),M=Y("input"),b=E(()=>[s.b(),s.is("focused",o.value),s.is("hovering",f.value),s.is("disabled",g.value),s.m(m.value),s.e("wrapper"),u.class]),c=E(()=>[u.style]),r=E(()=>{var C,D;return[s.e("inner"),s.is("draggable",e.draggable),s.is("left-space",!((C=e.modelValue)!=null&&C.length)&&!p.prefix),s.is("right-space",!((D=e.modelValue)!=null&&D.length)&&!T.value)]}),h=E(()=>{var C;return e.clearable&&!g.value&&!e.readonly&&(((C=e.modelValue)==null?void 0:C.length)||_.value)&&(o.value||f.value)}),T=E(()=>p.suffix||h.value||n.value&&v.value&&S.value);return{ns:s,nsInput:M,containerKls:b,containerStyle:c,innerKls:r,showClear:h,showSuffix:T}}const ua=ce({name:"ElInputTag",inheritAttrs:!1}),da=ce({...ua,props:la,emits:na,setup(e,{expose:o,emit:f}){const g=e,_=ta(),m=de(),{form:n,formItem:v}=je(),{inputId:S}=Je(g,{formItemContext:v}),u=E(()=>{var d;return(d=n?.statusIcon)!=null?d:!1}),p=E(()=>v?.validateState||""),s=E(()=>p.value&&Pe[p.value]),{inputRef:M,wrapperRef:b,isFocused:c,inputValue:r,size:h,tagSize:T,placeholder:C,closable:D,disabled:R,handleDragged:B,handleInput:x,handleKeydown:V,handleRemoveTag:I,handleClear:t,handleCompositionStart:l,handleCompositionUpdate:i,handleCompositionEnd:y,focus:P,blur:G}=oa({props:g,emit:f,formItem:v}),{hovering:Q,handleMouseEnter:ve,handleMouseLeave:pe}=sa(),{calculatorRef:ge,inputStyle:me}=aa(),{dropIndicatorRef:he,showDropIndicator:ye,handleDragStart:be,handleDragOver:Ce,handleDragEnd:Ee}=ra({wrapperRef:b,handleDragged:B,afterDragged:P}),{ns:N,nsInput:X,containerKls:Se,containerStyle:De,innerKls:_e,showClear:Te,showSuffix:we}=ia({props:g,hovering:Q,isFocused:c,inputValue:r,disabled:R,size:h,validateState:p,validateIcon:s,needStatusIcon:u});return o({focus:P,blur:G}),(d,fa)=>(k(),U("div",{ref_key:"wrapperRef",ref:b,class:w(a(Se)),style:He(a(De)),onMouseenter:a(ve),onMouseleave:a(pe)},[a(m).prefix?(k(),U("div",{key:0,class:w(a(N).e("prefix"))},[j(d.$slots,"prefix")],2)):q("v-if",!0),A("div",{class:w(a(_e))},[(k(!0),U(Re,null,xe(d.modelValue,(K,$)=>(k(),H(a(Ge),{key:$,size:a(T),closable:a(D),type:d.tagType,effect:d.tagEffect,draggable:a(D)&&d.draggable,"disable-transitions":"",onClose:O=>a(I)($),onDragstart:O=>a(be)(O,$),onDragover:O=>a(Ce)(O,$),onDragend:a(Ee),onDrop:se(()=>{},["stop"])},{default:J(()=>[j(d.$slots,"tag",{value:K,index:$},()=>[ze(oe(K),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),A("div",{class:w(a(N).e("input-wrapper"))},[ne(A("input",$e({id:a(S),ref_key:"inputRef",ref:M,"onUpdate:modelValue":K=>Ae(r)?r.value=K:null},a(_),{type:"text",minlength:d.minlength,maxlength:d.maxlength,disabled:a(R),readonly:d.readonly,autocomplete:d.autocomplete,tabindex:d.tabindex,placeholder:a(C),autofocus:d.autofocus,ariaLabel:d.ariaLabel,class:a(N).e("input"),style:a(me),onCompositionstart:a(l),onCompositionupdate:a(i),onCompositionend:a(y),onInput:a(x),onKeydown:a(V)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Le,a(r)]]),A("span",{ref_key:"calculatorRef",ref:ge,"aria-hidden":"true",class:w(a(N).e("input-calculator")),textContent:oe(a(r))},null,10,["textContent"])],2),ne(A("div",{ref_key:"dropIndicatorRef",ref:he,class:w(a(N).e("drop-indicator"))},null,2),[[Fe,a(ye)]])],2),a(we)?(k(),U("div",{key:1,class:w(a(N).e("suffix"))},[j(d.$slots,"suffix"),a(Te)?(k(),H(a(re),{key:0,class:w([a(N).e("icon"),a(N).e("clear")]),onMousedown:se(a(Ue),["prevent"]),onClick:a(t)},{default:J(()=>[Ke(a(Oe))]),_:1},8,["class","onMousedown","onClick"])):q("v-if",!0),a(p)&&a(s)&&a(u)?(k(),H(a(re),{key:1,class:w([a(X).e("icon"),a(X).e("validateIcon"),a(X).is("loading",a(p)==="validating")])},{default:J(()=>[(k(),H(qe(a(s))))]),_:1},8,["class"])):q("v-if",!0)],2)):q("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var ca=Be(da,[["__file","input-tag.vue"]]);const ba=We(ca);export{ba as E};
