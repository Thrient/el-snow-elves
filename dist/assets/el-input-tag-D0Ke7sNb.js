import{A as J,B as ae,C as x,D as Ve,I as ue,G as $,U as A,H as Ie,J as W,K as te,L as Me,M as Ne,N as de,r as ee,O as E,P as le,Q as ke,R as Z,S as Pe,T as Be,V as Re,W as ce,X as Le,e as fe,Y as $e,Z as xe,$ as ze,k as U,o as N,a0 as q,q as F,i as a,a1 as w,a2 as Q,a3 as ne,F as Fe,l as Ae,c as H,w as Y,a as Ke,t as oe,a4 as se,a5 as Oe,a6 as Ue,j as qe,a7 as He,h as We,a8 as Ge,a9 as Xe,aa as re,ab as je,ac as Je,ad as Qe}from"./index-BThFWz2V.js";import{t as ie,E as Ye}from"./el-scrollbar-cwunQwFk.js";import{u as Ze,a as ea}from"./index-DO5u6Usa.js";import{u as aa}from"./el-select-TaQLxnWU.js";import{u as ta}from"./el-col-C_2GaBf4.js";const la=Ve({modelValue:{type:te(Array)},max:Number,tagType:{...ie.type,default:"info"},tagEffect:ie.effect,trigger:{type:te(String),default:W.enter},draggable:{type:Boolean,default:!1},delimiter:{type:[String,RegExp],default:""},size:Ie,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),na={[A]:e=>ae(e)||x(e),[$]:e=>ae(e)||x(e),[ue]:e=>J(e),"add-tag":e=>J(e),"remove-tag":e=>J(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function oa({props:e,emit:o,formItem:f}){const g=Me(),T=Ne(),m=de(),n=ee(),v=E(()=>["small"].includes(T.value)?"small":"default"),S=E(()=>{var t;return(t=e.modelValue)!=null&&t.length?void 0:e.placeholder}),u=E(()=>!(e.readonly||g.value)),p=E(()=>{var t,l;return x(e.max)?!1:((l=(t=e.modelValue)==null?void 0:t.length)!=null?l:0)>=e.max}),s=t=>{var l,i;if(p.value){n.value=void 0;return}if(!P.value){if(e.delimiter){const y=(l=n.value)==null?void 0:l.replace(e.delimiter,"");y?.length!==((i=n.value)==null?void 0:i.length)&&(n.value=y,b())}o(ue,t.target.value)}},k=t=>{var l;if(!P.value)switch(t.code){case e.trigger:t.preventDefault(),t.stopPropagation(),b();break;case W.numpadEnter:e.trigger===W.enter&&(t.preventDefault(),t.stopPropagation(),b());break;case W.backspace:!n.value&&((l=e.modelValue)!=null&&l.length)&&(t.preventDefault(),t.stopPropagation(),c(e.modelValue.length-1));break}},b=()=>{var t,l;const i=(t=n.value)==null?void 0:t.trim();if(!i||p.value)return;const y=[...(l=e.modelValue)!=null?l:[],i];o(A,y),o($,y),o("add-tag",i),n.value=void 0},c=t=>{var l;const i=((l=e.modelValue)!=null?l:[]).slice(),[y]=i.splice(t,1);o(A,i),o($,i),o("remove-tag",y)},r=()=>{n.value=void 0,o(A,void 0),o($,void 0),o("clear")},h=(t,l,i)=>{var y;const B=((y=e.modelValue)!=null?y:[]).slice(),[G]=B.splice(t,1),X=l>t&&i==="before"?-1:l<t&&i==="after"?1:0;B.splice(l+X,0,G),o(A,B),o($,B)},_=()=>{var t;(t=m.value)==null||t.focus()},C=()=>{var t;(t=m.value)==null||t.blur()},{wrapperRef:D,isFocused:R}=Ze(m,{disabled:g,afterBlur(){var t;e.saveOnBlur?b():n.value=void 0,e.validateEvent&&((t=f?.validate)==null||t.call(f,"blur").catch(l=>le()))}}),{isComposing:P,handleCompositionStart:L,handleCompositionUpdate:V,handleCompositionEnd:I}=ea({afterComposition:s});return ke(()=>e.modelValue,()=>{var t;e.validateEvent&&((t=f?.validate)==null||t.call(f,$).catch(l=>le()))}),{inputRef:m,wrapperRef:D,isFocused:R,isComposing:P,inputValue:n,size:T,tagSize:v,placeholder:S,closable:u,disabled:g,inputLimit:p,handleDragged:h,handleInput:s,handleKeydown:k,handleAddTag:b,handleRemoveTag:c,handleClear:r,handleCompositionStart:L,handleCompositionUpdate:V,handleCompositionEnd:I,focus:_,blur:C}}function sa(){const e=ee(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function ra({wrapperRef:e,handleDragged:o,afterDragged:f}){const g=Z("input-tag"),T=de(),m=ee(!1);let n,v,S,u;function p(c){return`.${g.e("inner")} .${g.namespace.value}-tag:nth-child(${c+1})`}function s(c,r){n=r,v=e.value.querySelector(p(r)),v&&(v.style.opacity="0.5"),c.dataTransfer.effectAllowed="move"}function k(c,r){if(S=r,c.preventDefault(),c.dataTransfer.dropEffect="move",x(n)||n===r){m.value=!1;return}const h=e.value.querySelector(p(r)).getBoundingClientRect(),_=n+1!==r,C=n-1!==r,D=c.clientX-h.left,R=_?C?.5:1:-1,P=C?_?.5:0:1;D<=h.width*R?u="before":D>h.width*P?u="after":u=void 0;const L=e.value.querySelector(`.${g.e("inner")}`),V=L.getBoundingClientRect(),I=Number.parseFloat(Pe(L,"gap"))/2,t=h.top-V.top;let l=-9999;if(u==="before")l=Math.max(h.left-V.left-I,Math.floor(-I/2));else if(u==="after"){const i=h.right-V.left;l=i+(V.width===i?Math.floor(I/2):I)}Be(T.value,{top:`${t}px`,left:`${l}px`}),m.value=!!u}function b(c){c.preventDefault(),v&&(v.style.opacity=""),u&&!x(n)&&!x(S)&&n!==S&&o(n,S,u),m.value=!1,n=void 0,v=null,S=void 0,u=void 0,f?.()}return{dropIndicatorRef:T,showDropIndicator:m,handleDragStart:s,handleDragOver:k,handleDragEnd:b}}function ia({props:e,isFocused:o,hovering:f,disabled:g,inputValue:T,size:m,validateState:n,validateIcon:v,needStatusIcon:S}){const u=Re(),p=ce(),s=Z("input-tag"),k=Z("input"),b=E(()=>[s.b(),s.is("focused",o.value),s.is("hovering",f.value),s.is("disabled",g.value),s.m(m.value),s.e("wrapper"),u.class]),c=E(()=>[u.style]),r=E(()=>{var C,D;return[s.e("inner"),s.is("draggable",e.draggable),s.is("left-space",!((C=e.modelValue)!=null&&C.length)&&!p.prefix),s.is("right-space",!((D=e.modelValue)!=null&&D.length)&&!_.value)]}),h=E(()=>{var C;return e.clearable&&!g.value&&!e.readonly&&(((C=e.modelValue)==null?void 0:C.length)||T.value)&&(o.value||f.value)}),_=E(()=>p.suffix||h.value||n.value&&v.value&&S.value);return{ns:s,nsInput:k,containerKls:b,containerStyle:c,innerKls:r,showClear:h,showSuffix:_}}const ua=fe({name:"ElInputTag",inheritAttrs:!1}),da=fe({...ua,props:la,emits:na,setup(e,{expose:o,emit:f}){const g=e,T=ta(),m=ce(),{form:n,formItem:v}=$e(),{inputId:S}=xe(g,{formItemContext:v}),u=E(()=>{var d;return(d=n?.statusIcon)!=null?d:!1}),p=E(()=>v?.validateState||""),s=E(()=>p.value&&ze[p.value]),{inputRef:k,wrapperRef:b,isFocused:c,inputValue:r,size:h,tagSize:_,placeholder:C,closable:D,disabled:R,handleDragged:P,handleInput:L,handleKeydown:V,handleRemoveTag:I,handleClear:t,handleCompositionStart:l,handleCompositionUpdate:i,handleCompositionEnd:y,focus:B,blur:G}=oa({props:g,emit:f,formItem:v}),{hovering:X,handleMouseEnter:ve,handleMouseLeave:pe}=sa(),{calculatorRef:ge,inputStyle:me}=aa(),{dropIndicatorRef:he,showDropIndicator:ye,handleDragStart:be,handleDragOver:Ce,handleDragEnd:Ee}=ra({wrapperRef:b,handleDragged:P,afterDragged:B}),{ns:M,nsInput:j,containerKls:Se,containerStyle:De,innerKls:Te,showClear:_e,showSuffix:we}=ia({props:g,hovering:X,isFocused:c,inputValue:r,disabled:R,size:h,validateState:p,validateIcon:s,needStatusIcon:u});return o({focus:B,blur:G}),(d,fa)=>(N(),U("div",{ref_key:"wrapperRef",ref:b,class:w(a(Se)),style:Je(a(De)),onMouseenter:a(ve),onMouseleave:a(pe)},[a(m).prefix?(N(),U("div",{key:0,class:w(a(M).e("prefix"))},[Q(d.$slots,"prefix")],2)):q("v-if",!0),F("div",{class:w(a(Te))},[(N(!0),U(Fe,null,Ae(d.modelValue,(K,z)=>(N(),H(a(Ye),{key:z,size:a(_),closable:a(D),type:d.tagType,effect:d.tagEffect,draggable:a(D)&&d.draggable,"disable-transitions":"",onClose:O=>a(I)(z),onDragstart:O=>a(be)(O,z),onDragover:O=>a(Ce)(O,z),onDragend:a(Ee),onDrop:se(()=>{},["stop"])},{default:Y(()=>[Q(d.$slots,"tag",{value:K,index:z},()=>[Ke(oe(K),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),F("div",{class:w(a(M).e("input-wrapper"))},[ne(F("input",Ue({id:a(S),ref_key:"inputRef",ref:k,"onUpdate:modelValue":K=>qe(r)?r.value=K:null},a(T),{type:"text",minlength:d.minlength,maxlength:d.maxlength,disabled:a(R),readonly:d.readonly,autocomplete:d.autocomplete,tabindex:d.tabindex,placeholder:a(C),autofocus:d.autofocus,ariaLabel:d.ariaLabel,class:a(M).e("input"),style:a(me),onCompositionstart:a(l),onCompositionupdate:a(i),onCompositionend:a(y),onInput:a(L),onKeydown:a(V)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Oe,a(r)]]),F("span",{ref_key:"calculatorRef",ref:ge,"aria-hidden":"true",class:w(a(M).e("input-calculator")),textContent:oe(a(r))},null,10,["textContent"])],2),ne(F("div",{ref_key:"dropIndicatorRef",ref:he,class:w(a(M).e("drop-indicator"))},null,2),[[He,a(ye)]])],2),a(we)?(N(),U("div",{key:1,class:w(a(M).e("suffix"))},[Q(d.$slots,"suffix"),a(_e)?(N(),H(a(re),{key:0,class:w([a(M).e("icon"),a(M).e("clear")]),onMousedown:se(a(Xe),["prevent"]),onClick:a(t)},{default:Y(()=>[We(a(Ge))]),_:1},8,["class","onMousedown","onClick"])):q("v-if",!0),a(p)&&a(s)&&a(u)?(N(),H(a(re),{key:1,class:w([a(j).e("icon"),a(j).e("validateIcon"),a(j).is("loading",a(p)==="validating")])},{default:Y(()=>[(N(),H(je(a(s))))]),_:1},8,["class"])):q("v-if",!0)],2)):q("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var ca=Le(da,[["__file","input-tag.vue"]]);const ya=Qe(ca);export{ya as E};
